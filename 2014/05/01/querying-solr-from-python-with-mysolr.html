<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Querying Solr from Python with MySolr &middot; A Place to Remember
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="layout-reverse">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h2>
        <a href="/">
          A Place to Remember
        </a>
      </h2>
      <p class="lead">Thoughts, stories and ideas.</p>
    </div>

    <nav class="sidebar-nav">
      <!-- <a class="sidebar-nav-item" href="/">Home</a> -->

      <!-- 
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about.html">About</a>
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
       -->

      <!-- <a class="sidebar-nav-item" href="https://github.com/renodesper/archive/v.zip">Download</a>
      <a class="sidebar-nav-item" href="https://github.com/renodesper">GitHub project</a> -->
    </nav>

    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Querying Solr from Python with MySolr</h1>
  <span class="post-date">01 May 2014</span>
  <h2 id="introduction">Introduction</h2>

<p>MySolr is an API for Apache’s Solr for python. You can install mysolr using your favorite package manager. In the last post I have showed you how to update, select, and delete index using curl. Today, I will show you how we do those things using mysolr.<br />
Basic Configuration</p>

<p>There is nothing special with solr configuration. The first thing you should do is importing Solr from mysolr. If you have done that, you can set the connection. The default connection is http://localhost:8080. After that, we define what we want to query from solr and store it into a variable. You can print it afterward.<br />
Solr Query Example</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">mysolr</span> <span class="kn">import</span> <span class="n">Solr</span>

<span class="c"># We can also specify another connection like http://192.168.10.10:8983/solr/{core}</span>
<span class="n">solr</span> <span class="o">=</span> <span class="n">Solr</span><span class="p">()</span>

<span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s">'q'</span><span class="p">:</span><span class="s">'*:*'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">solr</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="o">**</span><span class="n">query</span><span class="p">)</span>

<span class="n">documents</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">documents</span>
<span class="k">print</span> <span class="n">documents</span>
</code></pre>
</div>

<p>I’ve tried to make a summary for mysolr basic usage and this is what I got:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">mysolr</span> <span class="kn">import</span> <span class="n">Solr</span>

<span class="c"># We can also specify another connection like</span>
<span class="c"># solr = Solr() or solr = Solr(auth=('admin', 'admin'))</span>
<span class="n">solr</span> <span class="o">=</span> <span class="n">Solr</span><span class="p">(</span><span class="s">"http://localhost:8983/solr/{core}"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">insertIndex</span><span class="p">():</span>
    <span class="c"># Create documents</span>
    <span class="n">documents</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">'id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s">'field1'</span><span class="p">:</span> <span class="s">'field content'</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">'id'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s">'field2'</span><span class="p">:</span> <span class="s">'field content'</span>
        <span class="p">}</span>
    <span class="p">]</span>

    <span class="c"># # Index using json with auto commit</span>
    <span class="c"># solr.update(documents, 'json', commit=True)</span>

    <span class="n">solr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">documents</span><span class="p">,</span> <span class="s">'json'</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c"># Index using json</span>
    <span class="n">solr</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  <span class="c"># Manual commit</span>


<span class="k">def</span> <span class="nf">selectIndex</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">solr</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="o">**</span><span class="n">query</span><span class="p">)</span>

    <span class="c"># For every document in response.documents print document</span>
    <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">documents</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">document</span>


<span class="k">def</span> <span class="nf">updateIndex</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">solr</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="o">**</span><span class="n">query</span><span class="p">)</span>

    <span class="c"># For every document in response.documents update title</span>
    <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">documents</span><span class="p">:</span>
        <span class="n">document</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'title'</span>

    <span class="n">solr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">documents</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="c"># Start here</span>
<span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s">'q'</span><span class="p">:</span> <span class="s">'*:*'</span><span class="p">}</span>

<span class="c"># # Inserting index</span>
<span class="c"># insertIndex()</span>

<span class="c"># Selecting index</span>
<span class="n">selectIndex</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="c"># # Updating index</span>
<span class="c"># updateIndex(query)</span>
</code></pre>
</div>

</div>


<div id="disqus_thread"></div>
<script>
	/*
    var disqus_config = function () {
        this.page.url = "https://blog.renodesper.com/";  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
        var d = document, s = d.createElement('script');
        
        s.src = '//aplacetoremember.disqus.com/embed.js';        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/10/04/berbagi-buku.html">
            Berbagi Buku
            <small>04 Oct 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/07/30/my-first-time-with-awk.html">
            My First Time with Awk
            <small>30 Jul 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/07/12/starting-screen-in-detach-mode.html">
            Starting Screen in Detach Mode
            <small>12 Jul 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
